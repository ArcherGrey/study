# 灰度变换与空间滤波
`空间域` 指图像平面本身，这类图像处理方法直接以图像中的像素操作为基础，这是相对于 `变换域` 中的图像处理而言的。


 `变换域` 的图像处理首先把一幅图像变换到变换域，在变换域中进行处理，然后通过反变换把处理结果返回到空间域。

 

> `空间域` 处理主要分为 `灰度变换` 和 `空间滤波`：
> 
- `灰度变换` 在图像的单个像素上操作，主要以对比度和阈值处理为目的。
-  `空间滤波` 涉及改善性能的操作，如通过图像中每一个像素的邻域处理来锐化图像。

----------

## 背景知识
 `空间域` 就是简单的包含图像像素的平面。

 `空间域技术` 就是通过某种变换函数（算子，模板？）对每一个像素进行计算。

通过算子对图像处理的过程称为 `空间滤波` 。其中，邻域和预定义的操作一起被称为 `空间滤波器`（空间掩模、核、模板或窗口）。最小邻域大小为 `1X1`，在使用最小邻域的图像操作，相当于只对对比度调整，称为 `对比度拉伸`。如果最后产生一幅二值图像，则称这种映射关系为 `阈值处理函数` 。

----------

## 基本的灰度变换函数
 `灰度变换` 是所有图像处理技术中最简单的技术。下面介绍几种常用的灰度变换函数（其中 r 和 s 分别代表处理前后的像素值）

> 图像反转

如果图像的灰度级范围是 `[0,L-1]` ，那么通过： `s = L - 1 - r` 来进行反转图像的灰度级，相当于得到等效的照片底片。

这种类型的处理适用于增强嵌入在一幅图像的暗区域中的白色或灰色细节，特别是黑色面积在尺寸上占主导地位时。

----------

> 对数变换

对数变换的形式是： `s = clog(1+r)`
，其中 c 是一个常数，r 假设大于 0 。

该变换将输入中范围较窄的低灰度值映射为输出中较宽范围的灰度值，对于高的输入灰度值是相反的作用。我们使用这种类型的变换来扩展图像中的暗像素的值，同时压缩更高灰度级的值。反对数变换的作用和这种相反。

----------

> 幂律（伽马）变换

幂律变换的基本形式是： <img src="http://www.forkosh.com/mathtex.cgi? s = cr^{\gamma}">

其中 c 和 <img src="http://www.forkosh.com/mathtex.cgi? \gamma"> 为正常数。

和对数变换相似，通过不同的 <img src="http://www.forkosh.com/mathtex.cgi? \gamma"> 值来实现和对数变换一样的效果，用于对图像获取、打印和显示各种设备根据幂律来产生的响应进行校正，称为 `伽马校正`（习惯上幂律方程中的指数称为伽马）。

----------

> 对比度拉伸

最简单的分段线性函数之一就是 `对比度拉伸变换`。通过对不同程度的灰度级扩展，来影响输出图像的对比度。


----------
> 灰度级分层

突出图像中特定灰度范围的亮度是很重要的，其应用包括增强特征。通常由两种方法来实现灰度级分层，一种是将感兴趣的范围内所有灰度值标记为一个值，其他的灰度值标记为另一个值，来产生一幅二值图像；第二种方法是使感兴趣的范围的灰度变亮或变暗，而保持其他的灰度值不变。


----------
> 比特平面分层

像素是由比特组成的数组。低阶比特平面在图像中贡献了更精细的灰度细节。当我们需要压缩图像的大小的时候，可以适当的放弃这些细节，通过高阶比特平面来重建图像，减少图像大小。

## 直方图处理
 `直方图` 是多种空间域处理技术的基础。直方图操作可用于图像增强。

> 直方图均衡

它的基本思想是对图像中像素个数多的灰度级进行展宽，而对图像中像素个数少的灰度进行压缩，从而扩展像原取值的动态范围，提高了对比度和灰度色调的变化，使图像更加清晰。

> 直方图匹配


直方图匹配——又叫直方图规定化（Histogram Normalization/Matching ）

 将图像直方图以标准图像的直方图为标准作变换,使两图像的直方图相同和近似,从而使两幅图像具有类似的色调和反差。

## 空间滤波基础

 `滤波` 是指接受或拒绝一定的频率分量。

> 空间滤波机理

空间滤波器由： 一个邻域 + 对邻域内的像素执行预定义操作

如果执行的是线性操作，则称滤波器为线性空间滤波器。否则称为非线性空间滤波器。

空间相关：是滤波器模板移过图像并计算每个位置乘积之和的处理。

空间卷积：把滤波器旋转180度。


----------
> 平滑线性滤波器

平滑线性空间滤波器的输出是包含在滤波器模板邻域内的像素的简单平均值，有时也称为均值滤波器。

平滑滤波器使用滤波器模板确定的邻域内像素的平均灰度值代替图像中的每个像素的值，可以降低图像的尖锐变换，不过同时会带来边缘模糊的负面效果。

> 统计排序滤波器

这种滤波器是一种非线性空间滤波器，以滤波器包围的图像区域中所包含的像素的排序为基础，使用统计排序结果决定的值代替中心像素的值。这类之中最有名的就是中值滤波器，对于处理椒盐噪声非常有效。


----------
> 锐化空间滤波器

锐化处理的主要目的是突出灰度的过度部分。锐化处理可以由空间微分来实现。
（二阶微分进行图像锐化 -- 拉普拉斯算子，一阶微分对图像锐化 -- 梯度）

> 非锐化掩蔽

在印刷和出版界使用多年的图像锐化处理过程是从原图像中减去一幅非锐化的版本，有下面几步：

- 模糊原图像
- 从原图像中减去模糊图像，得到模板
- 将模板加到原图像上

